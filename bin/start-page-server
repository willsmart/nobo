#!/bin/bash
args=$@
bindir=`realpath "$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"`
toolsdir="$bindir/../tools"

export pidfile="$bindir/../../page-server.pid"
function finish {
    res=$?
    rm -f "$pidfile"
    echo "page-server out"
    exit $res
}
trap finish EXIT INT TERM

cd "$toolsdir/page-server"
bundle exec rails s -p 3100 &
child=$!
echo $child > "$pidfile"
wait $child